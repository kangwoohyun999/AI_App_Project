{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar KEY = 'CONDITION_ENTRIES_V2';\nexport function saveEntry(_x) {\n  return _saveEntry.apply(this, arguments);\n}\nfunction _saveEntry() {\n  _saveEntry = _asyncToGenerator(function* (entry) {\n    try {\n      var raw = yield AsyncStorage.getItem(KEY);\n      var arr = raw ? JSON.parse(raw) : [];\n      arr.push(entry);\n      yield AsyncStorage.setItem(KEY, JSON.stringify(arr));\n      return true;\n    } catch (e) {\n      console.error('saveEntry error', e);\n      return false;\n    }\n  });\n  return _saveEntry.apply(this, arguments);\n}\nexport function getEntries() {\n  return _getEntries.apply(this, arguments);\n}\nfunction _getEntries() {\n  _getEntries = _asyncToGenerator(function* () {\n    try {\n      var raw = yield AsyncStorage.getItem(KEY);\n      return raw ? JSON.parse(raw) : [];\n    } catch (e) {\n      console.error('getEntries error', e);\n      return [];\n    }\n  });\n  return _getEntries.apply(this, arguments);\n}\nexport function getEntriesByDate(_x2) {\n  return _getEntriesByDate.apply(this, arguments);\n}\nfunction _getEntriesByDate() {\n  _getEntriesByDate = _asyncToGenerator(function* (dateStr) {\n    var all = yield getEntries();\n    return all.filter(function (e) {\n      return e.date.slice(0, 10) === dateStr;\n    }).sort(function (a, b) {\n      return new Date(b.date) - new Date(a.date);\n    });\n  });\n  return _getEntriesByDate.apply(this, arguments);\n}\nexport function clearEntries() {\n  return _clearEntries.apply(this, arguments);\n}\nfunction _clearEntries() {\n  _clearEntries = _asyncToGenerator(function* () {\n    try {\n      yield AsyncStorage.removeItem(KEY);\n      return true;\n    } catch (e) {\n      console.error('clearEntries error', e);\n      return false;\n    }\n  });\n  return _clearEntries.apply(this, arguments);\n}\nexport function computeWordTimeSeries() {\n  return _computeWordTimeSeries.apply(this, arguments);\n}\nfunction _computeWordTimeSeries() {\n  _computeWordTimeSeries = _asyncToGenerator(function* () {\n    var days = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 14;\n    var all = yield getEntries();\n    if (all.length === 0) {\n      return {\n        dates: [],\n        words: [],\n        data: {}\n      };\n    }\n    var today = new Date();\n    var dates = [];\n    for (var i = days - 1; i >= 0; i--) {\n      var d = new Date(today);\n      d.setDate(today.getDate() - i);\n      dates.push(d.toISOString().slice(0, 10));\n    }\n    var wordSet = new Set();\n    all.forEach(function (e) {\n      Object.keys(e.counts || {}).forEach(function (w) {\n        return wordSet.add(w);\n      });\n    });\n    var words = Array.from(wordSet).slice(0, 10);\n    var data = {};\n    words.forEach(function (w) {\n      return data[w] = [];\n    });\n    dates.forEach(function (d) {\n      var dayEntries = all.filter(function (e) {\n        return e.date.slice(0, 10) === d;\n      });\n      words.forEach(function (w) {\n        var sum = 0;\n        dayEntries.forEach(function (e) {\n          sum += e.counts && e.counts[w] ? e.counts[w] : 0;\n        });\n        data[w].push(sum);\n      });\n    });\n    return {\n      dates: dates,\n      words: words,\n      data: data\n    };\n  });\n  return _computeWordTimeSeries.apply(this, arguments);\n}","map":{"version":3,"names":["AsyncStorage","KEY","saveEntry","_x","_saveEntry","apply","arguments","_asyncToGenerator","entry","raw","getItem","arr","JSON","parse","push","setItem","stringify","e","console","error","getEntries","_getEntries","getEntriesByDate","_x2","_getEntriesByDate","dateStr","all","filter","date","slice","sort","a","b","Date","clearEntries","_clearEntries","removeItem","computeWordTimeSeries","_computeWordTimeSeries","days","length","undefined","dates","words","data","today","i","d","setDate","getDate","toISOString","wordSet","Set","forEach","Object","keys","counts","w","add","Array","from","dayEntries","sum"],"sources":["/Users/youlim/Documents/GitHub/AI_App_Project/Today_Condition/utils/storage.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\n\nconst KEY = 'CONDITION_ENTRIES_V2';\n\nexport async function saveEntry(entry) {\n  try {\n    const raw = await AsyncStorage.getItem(KEY);\n    const arr = raw ? JSON.parse(raw) : [];\n    arr.push(entry);\n    await AsyncStorage.setItem(KEY, JSON.stringify(arr));\n    return true;\n  } catch (e) {\n    console.error('saveEntry error', e);\n    return false;\n  }\n}\n\nexport async function getEntries() {\n  try {\n    const raw = await AsyncStorage.getItem(KEY);\n    return raw ? JSON.parse(raw) : [];\n  } catch (e) {\n    console.error('getEntries error', e);\n    return [];\n  }\n}\n\nexport async function getEntriesByDate(dateStr) {\n  const all = await getEntries();\n  return all.filter(e => e.date.slice(0,10) === dateStr).sort((a,b) => new Date(b.date) - new Date(a.date));\n}\n\nexport async function clearEntries() {\n  try {\n    await AsyncStorage.removeItem(KEY);\n    return true;\n  } catch (e) {\n    console.error('clearEntries error', e);\n    return false;\n  }\n}\n\nexport async function computeWordTimeSeries(days = 14) {\n  const all = await getEntries();\n  if (all.length === 0) {\n    return { dates: [], words: [], data: {} };\n  }\n  const today = new Date();\n  const dates = [];\n  for (let i = days - 1; i >= 0; i--) {\n    const d = new Date(today);\n    d.setDate(today.getDate() - i);\n    dates.push(d.toISOString().slice(0,10));\n  }\n\n  const wordSet = new Set();\n  all.forEach(e => {\n    Object.keys(e.counts || {}).forEach(w => wordSet.add(w));\n  });\n  const words = Array.from(wordSet).slice(0, 10);\n\n  const data = {};\n  words.forEach(w => data[w] = []);\n\n  dates.forEach(d => {\n    const dayEntries = all.filter(e => e.date.slice(0,10) === d);\n    words.forEach(w => {\n      let sum = 0;\n      dayEntries.forEach(e => {\n        sum += (e.counts && e.counts[w]) ? e.counts[w] : 0;\n      });\n      data[w].push(sum);\n    });\n  });\n\n  return { dates, words, data };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}